# Tinder as a Microservice Architecture.

The video "System Design: Tinder as a microservice architecture" discusses designing the Tinder microservice architecture by first considering the features of the app and how the system will evolve. The speaker debates whether to store images as files or blobs in a database and argues that files are cheaper, faster, and easier to work with. The video introduces the concept of a gateway service and suggests separate services for storing images and user profiles. The Matcher service is discussed, which keeps a table of user IDs that have matched with each other, and the speaker suggests using a NoSQL database like Cassandra. The video also covers sharding and horizontal partitioning for a distributed database and notes that breaking down the system into pieces and understanding partitioning is essential. The speaker concludes by inviting suggestions for other services to examine in a microservices architecture framework.

-----------------------------------------------------------

00:00:00 -> In this section, the speaker discusses how to approach the design of the Tinder microservice architecture. Rather than immediately thinking about what services and databases to use, the speaker suggests taking a step back and thinking logically about what features the app will provide and how the system will evolve. The two approaches to consider are starting with the ER diagram and thinking about how services will consume the data, or thinking about what users need as features and breaking down services to fulfill them. The speaker then discusses the features of Tinder, such as storing profiles and recommending matches, and encourages keeping the questions and assumptions fluffy and flying to avoid getting bogged down in details.


00:05:00 -> In this section, the speaker discusses the feature of storing profiles in the context of designing Tinder as a microservice architecture. Specifically, they debate the effectiveness of storing images as files versus storing them as blob (binary large object) in a database. The speaker argues that databases do not offer significant benefits for storing images over files, as images do not require mutability, transaction properties, or indexes, and access control can be achieved through a secure file system. The speaker notes that using a file system to store images is cheaper and more efficient for this purpose.


00:10:00 -> In this section, the speaker discusses the advantages of using the file system for storing images in a microservices architecture, as opposed to storing them in a database as blobs. He argues that files are cheaper, faster, and easier to work with due to the use of vertical partitioning and the ability to build a CDN for static content. He also explains how to implement an authentication mechanism using a token for the profile service in order to ensure that update requests to a user's profile are authenticated.


00:15:00 -> In this section, the video introduces the concept of a gateway service which takes requests from the client and authenticates them through the profile service to ensure they are authorized. The gateway then directs the requests to the correct service and sends the response back to the client, thus decoupling the systems and allowing for easier implementation of direct messaging protocols later on. Additionally, the video discusses the possibility of creating separate services for storing images and user profiles, as it could benefit other services that require images for machine learning or other purposes. Finally, the video suggests implementing direct messaging functionality by connecting clients through a client-server protocol like XMPP.


00:20:00 -> In this section, the video discusses the communication protocol and the importance of pushing messages instead of polling the server. The speaker explains the use of a peer-to-peer protocol like XMPP and WebSocket connections to maintain sessions, so users can talk to each other efficiently. The responsibility of maintaining connection information is decoupled from the gateway service and given to another service that handles sessions. However, two requirements still need attention: noting recommendations and suggesting people to match with. The speaker suggests storing the information of matched individuals on the client to avoid losing information, but also notes that the server should be the source of truth.


00:25:00 -> In this section, the video discusses how the Matcher service will keep a table of user IDs that have matched with one another, with indexes being put on each user ID. This allows the Matcher to check if a user is authenticated to send a direct message to another person. The video also covers how the Matcher service can note down matches, and how recommendation services work by optimizing on multiple parameters, such as age, gender, and location. It is suggested that a NoSQL database like Cassandra would work well for these queries to ensure an efficient system.


00:30:00 -> In this section, the speaker discusses two solutions for having a distributed database: using a distributed database like Cassandra or Amazon Dynamo, or using sharding on a relational database. Horizontal partitioning is a way to shard data by setting ranges in one column and directing the data to a location based on that range. Each database can have the age sorted, and the recommendation engine can pull out all relevant people based on the user's current location and filter out genders they are not interested in. The recommendation service can be simple, only pulling relevant users, but it's critical to shard the data based on the user's location. Although it may seem complex, breaking down the system into pieces and understanding the general gist of partitioning is essential.


00:35:00 -> In this section, the speaker notes that Tinder is a simpler service to design within a microservices architecture since there are fewer features and less complexity compared to other social media platforms. He suggests that one can remove single points of failure and design features using interactions with services to accomplish a Tinder-like architecture model. Additionally, the speaker ends by inviting suggestions for other services to examine within the microservices architecture framework.
